## JobManager setting (ignored by TaskManager)
jobmanager.rpc.address: jobmanager
# Mandatory memory configuration
# ðŸ’¡ Increase JobManager memory significantly (e.g., 4096m+)
#  to handle high parallelism, job submissions, and cluster coordination.
jobmanager.memory.process.size: 1024m

# TaskManager setting (ignored by JobManager)
taskmanager.numberOfTaskSlots: 6
taskmanager.memory.process.size: 2048m

# State backend
state.backend: rocksdb
state.backend.rocksdb.localdir: /tmp/rocksdb
state.backend.rocksdb.incremental: true
state.backend.rocksdb.predefined-options: FLASH_SSD_OPTIMIZED
state.backend.rocksdb.thread.num: 4
state.backend.rocksdb.memory.managed: true
# state.backend: hashmap

# Durable directories for checkpoints and savepoints
# ðŸ’¡ Ensure object storage is backed-up with appropriate lifecycle policies. 
state.checkpoints.dir: s3a://flink-checkpoints/checkpoints/
state.savepoints.dir: s3a://flink-savepoints/savepoints/

# Heartbeat
# ðŸ’¡ Defaults are often fine, but can be tuned for high-latency networks
heartbeat.interval: 1000
heartbeat.timeout: 5000

# REST settings (applicable to JobManager)
rest.port: 8081
rest.bind-address: 0.0.0.0
rest.flamegraph.enabled: true
rest.profiling.enabled: true
web.backpressure.refresh-interval: 10000

# MinIO
fs.s3a.access.key: admin
fs.s3a.secret.key: password
fs.s3a.endpoint: http://minio:9000
fs.s3a.path.style.access: true
fs.s3a.connection.ssl.enabled: false

# Metrics
metrics.reporters: prom
metrics.reporter.prom.factory.class: org.apache.flink.metrics.prometheus.PrometheusReporterFactory
metrics.reporter.prom.port: 9249

# Add this line to resolve dependency conflicts between Flink's core and its connectors.
classloader.resolve-order: parent-first

# Enable streaming Iceberg queries with OPTIONS
table.dynamic-table-options.enabled: true

# Checkpointing
# ðŸ’¡ While checkpointing should be configured by individual jobs. 
# For a safety net, consider adding sensible global defaults.
# This ensures no streaming job can be deployed without being fault-tolerant.
# execution.checkpointing.mode: EXACTLY_ONCE
# execution.checkpointing.interval: 1m
# execution.checkpointing.timeout: 10m
# execution.checkpointing.min-pause: 30s
# execution.checkpointing.tolerable-failed-checkpoints: 3
# execution.checkpointing.unaligned: true # Consider for high-backpressure scenarios

# # Faster task startup
# execution.runtime-mode: streaming
